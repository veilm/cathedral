<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>night-board</title>
<style>
:root{
  --page:#0c0c0f;
  --ink:#8899ff;
  --user:#ff8877;
  --pulse:#ffffff0a;
  font-family:"Lora","Georgia",serif;
  font-size:18px;
}
*{margin:0;padding:0;box-sizing:border-box;}
body{
  background:var(--page);
  color:var(--ink);
  height:100vh;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  overflow:hidden;
  position:relative;
}
#grain, #grain::after{
  content:"";
  position:absolute;
  inset:0;
  pointer-events:none;
  background:url('data:image/svg+xml,\
    <svg xmlns="http://www.w3.org/2000/svg" width="200" height="200">\
      <filter id="n"><feTurbulence type="fractalNoise" baseFrequency=".8" numOctaves="2" stitchTiles="stitch"/>\
      <feColorMatrix values="0 0 0 0 0   0 0 0 0 0   0 0 0 0 0   0 0 0 .4 0"/></filter>\
      <rect width="100%" height="100%" filter="url(%23n)"/></svg>');
  opacity:.35;
}
h1{position:absolute;top:8vh;letter-spacing:.4em;font-size:.8rem;color:var(--ink);opacity:.4;}
main{
  width:clamp(300px,80vw,720px);
  max-height:65vh;
  overflow:auto;
  scroll-behavior:smooth;
}
.message{
  margin:1.8rem 0;
  line-height:1.75;
  transition:padding .4s cubic-bezier(.4,0,.2,1);
}
.message.bodySleep{padding:.3rem 0;}
.user{color:var(--user);}
#ink-well{
  position:fixed;
  bottom:3rem;
  width:50px;
  height:50px;
  border-radius:50%;
  background:var(--pulse);
  backdrop-filter:blur(3px);
  cursor:text;
  transition:all .4s;
  overflow:hidden;
}
#ink-text{
  opacity:0;
  width:100%;
  min-height:0;
  max-height:0;
  background:transparent;
  border:0;
  color:var(--ink);
  font:inherit;
  resize:none;
  outline:none;
  transition:all .4s;
  padding:.4rem .2rem;
}
body.open #ink-well{
  width:clamp(300px,80vw,720px);
  height:120px;
  border-radius:28px;
  background:var(--pulse);
}
body.open #ink-text{
  opacity:1;
  max-height:100px;
  padding:.6rem .8rem;
}
::placeholder{color:var(--ink);opacity:.4;}
footer{position:fixed;bottom:1rem;font-size:.6rem;opacity:.25;}
</style>
</head>
<body>
<canvas id="grain"></canvas>
<h1>NIGHT-BOARD</h1>

<main id="chat">
  <p class="message">The room is quiet. Speak, and the ink will answer.</p>
</main>

<div id="ink-well">
  <textarea id="ink-text" placeholder="drop a word..."></textarea>
</div>

<footer>tap or press enter</footer>
<script>
/* ---------- breathing messages ---------- */
const breathe=()=>document.querySelectorAll('.message')
  .forEach(m=>m.classList.toggle('bodySleep',m.onIdle));
setInterval(breathe,2000);

/* ---------- ink drop expand / collapse ---------- */
const well  = document.getElementById('ink-well');
const field = document.getElementById('ink-text');
const chat  = document.getElementById('chat');
openForm   =()=> document.body.classList.add('open');
closeForm  =()=>{ document.body.classList.remove('open'); field.blur(); };
well.onclick = openForm;
field.addEventListener('blur', ()=>{ if(!field.value) closeForm(); });

/* ---------- one-line return-to-ink ---------- */
field.addEventListener('keydown', e=>{
  if(e.key==='Enter' && !e.shiftKey){
    e.preventDefault();
    if(!field.value.trim())return;
    const out=document.createElement('p');
    out.className='message user'; out.textContent=field.value;
    chat.appendChild(out);
    closeForm();
    setTimeout(()=>{
      const reply=document.createElement('p');
      reply.className='message'; 
      reply.textContent='the board listens, then sighs.';
      chat.appendChild(reply);
      reply.scrollIntoView();
    },700);
    field.value='';
  }
});
</script>
</body>
</html>
