<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>twilight-study</title>
<style>
:root{
  --bg:#1a1419;
  --ink:#cfc8c0;
  --user:#a09590;
  --rule:#352b34;
  --accent:#6b5d68;
  --wine:#704050;
  --brass:#9a8670;
  --shadow:linear-gradient(180deg, #2a1828 0%, transparent 30%);
  font-size:17px;
  line-height:1.72;
}
*{margin:0;padding:0;box-sizing:border-box;}
body{
  background:var(--bg);
  background-image:
    var(--shadow),
    radial-gradient(circle at 30% 50%, #2a202815, transparent 40%);
  color:var(--ink);
  font-family:"Literata","Baskerville",serif;
  display:flex;
  flex-direction:column;
  height:100vh;
  padding:0 clamp(1rem, 4vw, 4rem);
}
body::before{
  content:"";
  position:fixed;
  top:15%;
  left:10%;
  width:120px;
  height:120px;
  background:radial-gradient(circle, #9a867010, transparent 70%);
  border-radius:50%;
  filter:blur(40px);
  pointer-events:none;
  animation:lampglow 12s infinite ease-in-out;
}
@keyframes lampglow{
  0%,100%{opacity:0.4;transform:scale(1);}
  50%{opacity:0.6;transform:scale(1.1);}
}
header{
  flex-shrink:0;
  padding:2rem 0 1.3rem;
  border-bottom:1px solid var(--rule);
  font-size:.8rem;
  color:var(--accent);
  letter-spacing:0.18em;
  font-variant:small-caps;
}
main{
  flex:1 1 auto;
  overflow:auto;
  padding:2.6rem 0;
  scrollbar-width:thin;
  scrollbar-color:var(--rule) transparent;
}
.message{
  max-width:41rem;
  margin:0 auto 2rem;
  position:relative;
}
.message .text{
  position:relative;
}
.message .text::first-letter{
  font-size:1.4em;
  line-height:1;
  font-weight:400;
  color:var(--brass);
  margin-right:0.02em;
}
.user .text{
  font-weight:380;
  font-size:0.94em;
  margin-left:1.5rem;
  text-indent:-0.6rem;
  color:var(--user);
}
.user .text::first-letter{
  font-size:1.2em;
  color:var(--wine);
}
.collapsed{
  max-height:4.4em;
  overflow:hidden;
  mask-image:linear-gradient(180deg, black 70%, transparent);
}
.expand{
  position:absolute;
  bottom:.2rem;
  right:0;
  background:linear-gradient(135deg, var(--wine), var(--accent));
  border:0;
  color:var(--ink);
  font-size:.65rem;
  cursor:pointer;
  padding:.2rem .6rem;
  border-radius:12px;
  letter-spacing:0.1em;
  opacity:0.6;
  font-weight:600;
}
.expand:hover{
  opacity:0.9;
}
hr{
  border:0;
  margin:2.4rem auto;
  max-width:41rem;
  text-align:center;
  position:relative;
  height:20px;
}
hr::before{
  content:"§";
  position:absolute;
  left:50%;
  top:50%;
  transform:translate(-50%, -50%);
  color:var(--wine);
  font-size:1.2rem;
  font-weight:300;
  opacity:0.5;
}
footer{
  flex-shrink:0;
  padding:1.5rem 0 2.3rem;
  display:flex;
  gap:1rem;
  align-items:center;
  justify-content:center;
}
textarea{
  flex:1;
  max-width:41rem;
  border:1px solid var(--rule);
  background:linear-gradient(180deg, transparent, #00000008);
  color:var(--ink);
  font:inherit;
  resize:none;
  outline:none;
  min-height:3rem;
  padding:0.8rem 1rem;
  border-radius:4px;
  box-shadow:inset 0 1px 3px #00000020;
}
textarea:focus{
  border-color:var(--wine);
  background:linear-gradient(180deg, transparent, #00000012);
}
textarea::placeholder{
  color:var(--accent);
  opacity:0.45;
  font-style:italic;
}
#settings{
  position:fixed;
  bottom:1.5rem;
  right:1.7rem;
  width:21px;
  height:21px;
  cursor:pointer;
  opacity:.3;
  transition:.25s;
  filter:sepia(0.3);
}
#settings:hover{
  opacity:.5;
  transform:rotate(120deg);
}

/* manuscript table */
.manuscript-table{
  margin:2.4rem auto;
  max-width:37rem;
  border-collapse:collapse;
  font-size:0.88em;
  position:relative;
}
.manuscript-table::before{
  content:"";
  position:absolute;
  top:-10px;
  left:50%;
  transform:translateX(-50%);
  width:80%;
  height:1px;
  background:linear-gradient(90deg, transparent, var(--brass) 40%, var(--brass) 60%, transparent);
  opacity:0.3;
}
.manuscript-table th,
.manuscript-table td{
  padding:0.95rem 1.1rem;
  text-align:left;
}
.manuscript-table th{
  color:var(--brass);
  font-weight:400;
  letter-spacing:0.12em;
  font-variant:small-caps;
  font-size:0.85em;
  border-bottom:1px solid var(--rule);
}
.manuscript-table td{
  border-bottom:1px dotted #ffffff08;
}
.manuscript-table tr:last-child td{
  border-bottom:none;
}
.manuscript-table td:first-child{
  color:var(--wine);
  font-style:italic;
  padding-left:1.8rem;
}
.manuscript-table td:last-child{
  text-align:right;
  color:var(--accent);
  font-size:0.9em;
}

/* ink drops */
.ink{
  position:fixed;
  width:2px;
  height:2px;
  background:var(--wine);
  border-radius:50%;
  opacity:0;
  pointer-events:none;
  animation:inkfall 15s infinite;
}
@keyframes inkfall{
  0%{opacity:0;transform:translateY(0);}
  10%{opacity:0.3;}
  90%{opacity:0.1;}
  100%{opacity:0;transform:translateY(100px);}
}
</style>
</head>
<body>
<header>evening letters</header>

<main id="chat">
  <div class="message">
    <p class="text">
      The lamp burns low, casting amber pools across the page. 
      In this hour between worlds, when shadows grow long and thoughts grow deep,
      every word you write carries the weight of dusk.
    </p>
  </div>
  
  <table class="manuscript-table">
    <thead>
      <tr>
        <th>Chapter</th>
        <th>Theme</th>
        <th>Page</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>Prelude</td>
        <td>The question unasked</td>
        <td>vii</td>
      </tr>
      <tr>
        <td>First</td>
        <td>What memory keeps</td>
        <td>3</td>
      </tr>
      <tr>
        <td>Second</td>
        <td>Letters never sent</td>
        <td>27</td>
      </tr>
      <tr>
        <td>Third</td>
        <td>The space between words</td>
        <td>51</td>
      </tr>
      <tr>
        <td>Epilogue</td>
        <td>Morning, eventually</td>
        <td>89</td>
      </tr>
    </tbody>
  </table>
</main>

<footer>
  <textarea placeholder="write by lamplight…" rows="1"></textarea>
</footer>

<svg id="settings" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8">
  <circle cx="12" cy="12" r="3"/>
  <path d="M12 1v6m0 6v6m11-7h-6m-6 0H1m20.4-4.6l-4.2 4.2m-12 12l-4.2 4.2m12-20.8l-4.2 4.2M7.6 7.6L3.4 3.4"/>
</svg>

<script>
/* ---------- ink drops ---------- */
for(let i=0;i<3;i++){
  const ink=document.createElement('div');
  ink.className='ink';
  ink.style.left=(20+Math.random()*60)+'%';
  ink.style.top=(10+Math.random()*20)+'%';
  ink.style.animationDelay=(i*5)+'s';
  document.body.appendChild(ink);
}

/* ---------- expand/collapse ---------- */
function maybeCollapse(p){
  if(p.scrollHeight > 4.4 * parseFloat(getComputedStyle(p).fontSize)){
    p.classList.add('collapsed');
    const btn=document.createElement('button');
    btn.className='expand';
    btn.textContent='more';
    btn.onclick=()=>{
      p.classList.toggle('collapsed');
      btn.textContent = p.classList.contains('collapsed') ? 'more' : 'less';
    };
    p.parentNode.appendChild(btn);
  }
}
document.querySelectorAll('.text').forEach(maybeCollapse);

/* ---------- minimal chat loop ---------- */
const chat=document.getElementById('chat');
const ta=document.querySelector('textarea');
const send=()=>{
  const val=ta.value.trim();
  if(!val)return;
  const div=document.createElement('div');
  div.className='message user';
  div.innerHTML=`<p class="text">${val}</p>`;
  chat.appendChild(div);
  maybeCollapse(div.querySelector('p'));
  
  const hr=document.createElement('hr');
  chat.appendChild(hr);

  setTimeout(()=>{
    const reply=document.createElement('div');
    reply.className='message';
    reply.innerHTML=`<p class="text">
      The words settle into the margins like pressed flowers between pages.
      Here in the lamplight's embrace, every thought becomes a letter to tomorrow,
      sealed with wax and shadow.
    </p>`;
    chat.appendChild(reply);
    maybeCollapse(reply.querySelector('p'));
    hr.scrollIntoView({behavior:'smooth'});
  },950);
  ta.value='';
};
ta.addEventListener('keydown',e=>{
  if(e.key==='Enter' && !e.shiftKey){e.preventDefault();send();}
});
</script>
</body>
</html>