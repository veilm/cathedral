<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>margin-lamp</title>  
<style>
:root{
  --page:#0d0d0e;
  --lamp:#f5f0e5;
  --ink:#a9a59f;
}
*{margin:0;padding:0;box-sizing:border-box;}
body{
  background:var(--page);
  color:var(--ink);
  font-family:"SF Mono","JetBrains Mono",monospace;
  font-size:14px;
  line-height:1.4;
  height:100vh;
  display:flex;
  flex-direction:column;
  align-items:center;
  padding:10vh 6vw;
  overflow:hidden;
}
#journal{
  width:100%;
  max-width:34rem;
  height:70vh;
  overflow-y:auto;
  position:relative;
}
.message{
  margin:0 0 1.8rem;
  opacity:0;               /* hidden by default */
  transition:opacity .5s ease;
}
.message.show{opacity:1;}
.message.user{color:var(--lamp);}
footer{
  margin-top:2vh;
  cursor:text;
}
#cursor{
  font-size:1.6rem;
  color:var(--lamp);
  animation:blink 1.2s steps(2,start) infinite;
}
@keyframes blink{50%{opacity:0;}}
</style>
</head>
<body>
<div id="journal">
  <p class="message assistant show">the room is quiet. speak in the dark.</p>
</div>
<footer>
  <span id="cursor">_</span>
</footer>

<script>
const journal = document.getElementById('journal');
const cursor  = document.getElementById('cursor');
const showNearby = () => journal.className = 'near'; // CSS will reveal

const add = (txt,cls) => {
  const p = document.createElement('p');
  p.className = 'message ' + cls;
  p.textContent = txt;
  journal.appendChild(p);
  p.scrollIntoView({behavior:'smooth'});
  setTimeout(()=>p.classList.add('show'),20);
};

/* reveal messages on hover or scroll */
journal.addEventListener('mousemove',(e)=>{
  journal.querySelectorAll('.message').forEach(m=>{
    const rect=m.getBoundingClientRect();
    const dist=Math.abs(e.clientY - (rect.top+rect.height/2));
    m.style.opacity = dist<150 ? 1 : .15;
  });
});

/* minimal input via underscore */
let buffer='';
window.addEventListener('keydown',e=>{
  if(e.key==='Enter'){
    if(!buffer.trim()) return;
    add(buffer.trim(),'user');
    buffer='';
    cursor.textContent='_';
    setTimeout(()=>add('(response slowly lights up)','assistant'),700);
  } else if(e.key==='Backspace'){
    buffer=buffer.slice(0,-1);
  } else if(e.key.length===1){
    buffer+=e.key;
  }
  cursor.textContent=buffer.slice(-40)+'_';
});
</script>
</body>
</html>
